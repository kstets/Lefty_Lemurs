---
title: "LeftyLemursAnalysis"
author: "Kate Stetson"
date: "`r Sys.Date()`"
output: html_document
---

Loading library
```{r}
library(tidyverse)
library(readr)
library(dplyr)
library(ggplot2)
```

Upload clean data (it was a nightmare of cleaning this data in R and Excel and took many terrible hours, of which I do not wish to relive)
```{r}
L <- read.csv("~/Documents/GitHub/Lefty_Lemurs/LeftyLemurs_Clean.csv")
```


**Analysis**

~Hex codes for colors (to use in graphs)~
Red: #C84E00
Orange: #E89923
Yellow: #FFD960
Light Green: #A1B70D
Turquoise: #339898
Teal: #1D6363
Medium Blue: #005587
Light Blue: #0577B1
Purple: #993399

```{r}
head(L)
```

Let's look at how many total instances of each limb use there was
```{r}
table(L$Limb)
```
Omg ðŸ™Š

Left Hand: 225
Right Hand: 318
Left Foot: 32
Right Foot: 47

It looks like lemurs used their right hands a lot more than they used their left hands...

```{r}
 ggplot (L, aes(x= reorder (Limb, Limb, table ))) +
  geom_bar(color = "black", fill = "#012169") +
  theme_classic() +
  xlab("Limb") +
  ylab("Total Times Using Each Limb") +
  ggtitle("Total Limb Use Across Lemurs") +
  coord_flip()
```

Yep, there definitely appears to be a hand/foot preference


```{r}
ggplot (L, aes(x= reorder (Limb, Limb, table ))) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Limb") +
  ylab("Total Times Using Each Limb") +
  ggtitle("Total Limb Use Across Lemur Species") +
  coord_flip() +
  facet_wrap (~ Species, scales = "free")
```

```{r}
ggplot (L, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Left or Right Side") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Limb Use Between Lemur Species") +
  facet_wrap (~ Species, scales = "free")
```

```{r}
ggplot (L, aes(x= reorder (Side, Side, table ))) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Left or Right") +
  ylab("Total Times Using Each Limb") +
  ggtitle("Limb Use Between Lemur Species") +
  coord_flip() +
  facet_wrap (~ Species, scales = "free")
```

Same thing but on the same scale (I got more data from sifakas as u can see)
```{r}
ggplot (L, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Left or Right Side") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Limb Use Between Lemur Species") +
  facet_wrap (~ Species,)
```

ðŸ‘€
Sifakas have higher left hand use than the other 2 species. Sifakas overall seem more ambidextrous. However, this could be due to them foraging more (maybe all lemurs forage more with their left hands or something idk). Therefore I should separate it out by eating behaviors.

What about by sex
```{r}
ggplot (L, aes(x= reorder (Limb, Limb, table ))) +
  geom_bar(color = "black", fill = "#1D6363") +
  theme_classic() +
  xlab("Limb") +
  ylab("Total Times Using Each Limb") +
  ggtitle("Total Limb Use Between Sexes: Lemurs Are Not Lefties") +
  coord_flip() +
  facet_wrap (~ Sex, scales = "free")
```
```{r}
ggplot (L, aes(x= reorder (Side, Side, table ))) +
  geom_bar(color = "black", fill = "#1D6363") +
  theme_classic() +
  xlab("Left or Right") +
  ylab("Total Times Using Each Limb") +
  ggtitle("Total Limb Use Between Sexes: Lemurs Are Not Lefties") +
  coord_flip() +
  facet_wrap (~ Sex, scales = "free")
```

Definitely more right hand than left HAND use for both males and females. Not sure about foot use, but I didn't get much foot use data to begin with. Is there a way to exclude foot use?

Males might me a little less lateralized than females? Left hand use is also (slightly) higher in males like I thought it would be!

---
```{r}
ggplot (L, aes(x= reorder (Category, Category, table ))) +
  geom_bar(color = "black", fill = "#0577B1") +
  theme_classic() +
  xlab("Type of Behavior") +
  ylab("Total Times Using Each Limb") +
  ggtitle("Behavior Across Sexes") +
  coord_flip() +
  facet_wrap (~ Sex,scales = "free")
```
Everyone eats a lot

---

I need to figure out how to convert it from counts to percentages.

Could I put hand use as a percent?

Like one lemur uses left hand 35% of the time? And do that as a bar graph?

---
~Hex codes for colors~
Red: #C84E00
Orange: #E89923
Yellow: #FFD960
Light Green: #A1B70D
Turquoise: #339898
Teal: #1D6363
Medium Blue: #005587
Light Blue: #0577B1
Purple: #993399


Some calculations
```{r}
summary(L)

library(psych)

describeBy(L[c(4,1:12)], group = "Category")
# what does the 4 mean??
```


Making a DF with just hand grasp data
```{r}

# take out feet use data

l_hands <-
  L %>%
  select(H.F) %>%
  filter(str_detect(H.F, "H"))

# add the other stuff back
l_hands <- inner_join(l_hands, L, by = "H.F")

l_hands <- unique(l_hands)

# actually I also don't want to look at all the categories bc some were added just for fun and are probably not important

l_handstuff <-
  l_hands %>%
  select(Category) %>%
  filter(str_detect(Category, "E|L|R|SG"))


# WHY WON'T IT TAKE OUT LA

# add the other stuff back why did it even go away

l_handstuff <- inner_join(l_handstuff, l_hands, by = "Category")

# I can remove the H.F row because all of it is hand 

l_handstuff <- l_handstuff %>% select(-H.F)

# removing Limb row bc side says the same thing

l_handstuff <- l_handstuff %>% select(-Limb)

# removing mystery duplicates

l_handstuff <- unique(l_handstuff)


l_noLA <- 
l_handstuff %>% 
  filter(Category == "E"  |  Category == "L" |  Category == "R" |  Category == "SG" | Category != "LA" )

#wow I forgot you can do that

```

Compare hand use by species
```{r}
ggplot (l_noLA, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Left or Right Side") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Hand Use Between Lemur Species") +
  facet_wrap (~ Species, scales = "free")
```

```{r}
ggplot (l_noLA, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Left or Right Side") +
  ylab("Type of Behavior") +
  ggtitle("Hand Use Between Behaviors") +
  facet_wrap (~ Category, scales = "free")
```
So it looks like lemurs mostly ue their right hand for everything except for grooming! Interesting


Now I'm going to filter out the grooming data so it's all grasping
```{r}
l_grasps <-
l_noLA %>% 
  filter(Category == "E"  |  Category == "L" |  Category == "R")
```

Compare grasping hand by species
```{r}
ggplot (l_grasps, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Left or Right Side") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Hand Use for Grasping Between Lemur Species") +
  facet_wrap (~ Species, scales = "free")
```

What about by sex?
```{r}
ggplot (l_grasps, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Left or Right Side") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Hand Use for Grasping Between Sexes") +
  facet_wrap (~ Sex, scales = "free")
```
It doesn't look like there's really a difference


What about just food grasps?
```{r}
l_foodGrasps <-
l_grasps %>% 
  filter(Category == "E")
```

Compare grasping hand by species
```{r}
ggplot (l_foodGrasps, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Left or Right Side") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Hand Use for Food Grasping Between Lemur Species") +
  facet_wrap (~ Species, scales = "free")
```
It really looks like sifakas are more ambidextrous when it comes to food grasping!

What about by individual?
```{r}
ggplot (l_foodGrasps, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Left or Right Side") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Hand Use for Food Grasping Between Individuals") +
  facet_wrap (~ Focal, scales = "free")
```
It kind of looks like Sophia and Thrax are lefties!!! And Licinius is close... The other lemurs look like righties!

Look at them all on the same scale
```{r}
ggplot (l_foodGrasps, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Left or Right Side") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Hand Use for Food Grasping Between Individuals") +
  facet_wrap (~ Focal)
```
Okay there isn't much data for Sophia so it could just be "noise" for her... But Thrax has a lot of data

But is all of this actually statistically significant ðŸ‘€
```{r}
mean(l_foodGrasps$Side_Num)
```
does this mean 39.3% of grasps were with left hand?
idk

```{r}
ggplot (l_noLA, aes(x= Category)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Activity") +
  ylab("Occurrences") +
  ggtitle("Hand Use for Activities by Species") +
  facet_wrap (~ Species)
```

This just does occurrences. How can I get the Y-axis to be % of L compared to R?

Idk

```{r}
ggplot (l_foodGrasps, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Activity") +
  ylab("Occurrences") +
  ggtitle("Hand Used for Food Grasping Between Species") +
  facet_wrap (~ Species)
```

```{r}
ggplot (l_foodGrasps, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Left or Right Side") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Hand Use for Grasping Between Individuals") +
  facet_wrap (~ Focal, scales = "free" )
```

```{r}
ggplot (l_foodGrasps, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Side") +
  ylab("Occurrences") +
  ggtitle("Hand Used for Food Grasping Between Species") +
  facet_wrap (~ Species)
```


```{r}
ggplot (L, aes(x= Focal)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Focal") +
  ylab("Occurrences") +
  ggtitle("# of Times Using Each Limb") +
  facet_wrap (~ Side)
```

```{r}
ggplot (l_foodGrasps, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Side") +
  ylab("Occurrences") +
  ggtitle("Hand Used for Food Grasping Between Sex") +
  facet_wrap (~ Sex, scales = "free")
```

Trying some statistical tests
```{r}
L %>% 
  group_by(Side) %>% 
  summarise (n = n()) %>%
  mutate(proportion = n / sum(n))

l_handstuff %>% 
  group_by(Side) %>% 
  summarise (n = n()) %>%
  mutate(proportion = n / sum(n))

binom.test(218, 305, p = .75, alternative = "two.sided")
```

Trying to do chi-squared test and contigency coefficients (did not work)
```{r}
# tbl_handGrasps <- as.data.frame(l_noLA) %>% 
  group_by(Side, Sex) %>% 
  summarize(qty = sum(Freq)) %>% 
  ungroup() %>% 
  spread(key = Sex, value = qty)

# mat_handGrasps <- as.matrix(tbl_handGrasps[-1])
rownames(mat_handGrasps) <- levels(tbl_handGrasps$Side)

# chisq.test(mat_handGrasps)
```
It says it can't because it doesnt understand "Freq"

```{r}
ggplot (l_grasps, aes(x= Side)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Left or Right Side") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Hand Use for Grasping Between Sexes") +
  facet_wrap (~ Sex, scales = "free")
```

```{r}
ggplot (L, aes(x= Limb)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Limb") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Limb Use Between Individuals") +
  facet_wrap (~ Focal)
```
Not a lot of foot use. It might not be very useful to include these data


Just look at bipedal locomotion
```{r}
l_feet <- 
L %>% 
  filter(Category == "BP")

ggplot (l_feet, aes(x= Limb)) +
  geom_bar(color = "black", fill = "#C84E00") +
  theme_classic() +
  xlab("Limb") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Limb Use Between Individuals") +
  facet_wrap (~ Focal)
```
I don't really see any overall patterns here. It looks like Furia leads with her right foor more than left and Thrax leads a little more with his left foot than right. 

Does age impact hand use?
```{r}
ggplot(L, aes(x = Category, y = Age, color = Side)) + 
  geom_jitter()  +
  theme_classic() +
  xlab("Type of Behavior") +
  ylab("Age of Lemur") +
  ggtitle("Does Age Affect Limb Use?") + 
  scale_color_manual(values = c("#1D6363", "#E89923"))
```
Yeah I don't think it does lol


Trying to make the graph I yearn for
```{r}
ggplot (l_noLA, aes(x= Category, fill = Side)) +
  geom_bar(color = "black") +
  theme_classic() +
  xlab("Type of Behavior") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Limb Use Between Lemur Species") +
  facet_wrap (~ Species, scales = "free") + 
  scale_fill_manual(values = c("#1D6363", "#E89923"))
```
It's still not exactly what I want. I want the Y-axis to be % of grasps being with left hand, not total times used. Splitting by color makes it really hard to read, but Idk how else to do it :P

```{r}
ggplot (l_noLA, aes(x= Side, fill = interaction(Category, Side))) +
  geom_bar(color = "black") +
  theme_classic() +
  xlab("Left or Right Side") +
  ylab("# of Times Using Each Limb") +
  ggtitle("Limb Use Between Lemur Species") +
  facet_wrap (~ Species, scales = "free")
```
Wow that it was too complicated. Why did I dare make this monstrosity?



